
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Requiring CakePHP 2.x using Composer - Daves dev warblings</title>
  <meta name="author" content="David Yell">

  
  <meta name="description" content="Scenario You have started your project using one of the 2.x downloads. Now you are using Composer to pull in your plugins, but you are still having &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://jedistirfry.co.uk/blog/2014-07/converting-your-2-dot-x-application-to-require-cakephp">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Daves dev warblings" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-2775424-18']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Daves dev warblings</a></h1>
  
    <h2>For all the things I never remember</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:jedistirfry.co.uk" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
  <li><a href="/about.html">About</a></li>
  <li><a href="/CakePHP-Listing">CakePHP Listing plugin</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Requiring CakePHP 2.x using Composer</h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-07-31T15:00:34+01:00" pubdate data-updated="true">Jul 31<sup>st</sup>, 2014</time>
        
      </p>
    
  </header>


<div class="entry-content"><h3>Scenario</h3>

<p>You have started your project using one of the 2.x downloads. Now you are using Composer to pull in your plugins, but you are still having to commit the framework to your repo.</p>

<p>So it&rsquo;s time to remove your CakePHP lib and start requiring it as a dependancy instead.</p>

<p>I will assume you are fimiliar with <a href="http://getcomposer.org/">Composer</a>.</p>

<h3>Solution</h3>

<p>So it&rsquo;s actually pretty straight forward. For the sake of this example, we will assume that you have a standard layout in your current project.</p>

<p>If you are not familiar with the current layout, <a href="https://github.com/cakephp/cakephp/tree/2.5.3">take a quick look at the 2.5.3 tag</a> to check the folders.</p>

<p>To see what we are aiming at, <a href="https://github.com/FriendsOfCake/app-template">check out the Friends of Cake app-template</a>.</p>

<p>If you don&rsquo;t already have a <code>composer.json</code> file, then you&rsquo;ll want to create that. <code>composer init</code> inside your project folder.</p>

<h4>Adding the framework</h4>

<p>Firstly we want to let Composer know that you want to require the framework, so let&rsquo;s update the <code>composer.json</code> to add the following to your <code>require</code> section.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='json'><span class='line'><span class="s2">&quot;cakephp/cakephp&quot;</span><span class="err">:</span> <span class="s2">&quot;2.5.3&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<p>You can pick your version here if you want to lock in the version, which I&rsquo;d recommend. Or you could specify another version, such as <code>2.5.*</code>. <a href="https://getcomposer.org/doc/01-basic-usage.md#package-versions">Check the Composer docs for more on versions</a>.</p>

<p>When you <code>composer update</code> now it should download the framework for you into <code>vendors/cakephp/cakephp</code>.</p>

<h4>Pointing to the correct core</h4>

<p>The next task is to tell CakePHP that we have a new place for it to find the core. There are only really a few files you need to update.</p>

<ul>
<li><code>app/webroot/index.php</code></li>
<li><code>app/Console/cake.php</code></li>
</ul>


<p><strong>app/webroot/index.php</strong><br/>
You&rsquo;ll want to update the <code>ROOT</code>, <code>APP_DIR</code>, <code>TMP</code> and the <code>CAKE_CORE_INCLUDE_PATH</code> constants.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='php'><span class='line'><span class="nb">define</span><span class="p">(</span><span class="s1">&#39;ROOT&#39;</span><span class="p">,</span> <span class="nb">dirname</span><span class="p">(</span><span class="nb">dirname</span><span class="p">(</span><span class="k">__FILE__</span><span class="p">)));</span>
</span><span class='line'><span class="nb">define</span><span class="p">(</span><span class="s1">&#39;APP_DIR&#39;</span><span class="p">,</span> <span class="s1">&#39;app&#39;</span><span class="p">);</span> <span class="c1">// I define this as a string because why not right?</span>
</span><span class='line'><span class="nb">define</span><span class="p">(</span><span class="s1">&#39;TMP&#39;</span><span class="p">,</span> <span class="nx">ROOT</span> <span class="o">.</span> <span class="nx">DS</span> <span class="o">.</span> <span class="s1">&#39;tmp&#39;</span> <span class="o">.</span> <span class="nx">DS</span><span class="p">);</span>
</span><span class='line'><span class="nb">define</span><span class="p">(</span><span class="s1">&#39;CAKE_CORE_INCLUDE_PATH&#39;</span><span class="p">,</span> <span class="nx">ROOT</span> <span class="o">.</span> <span class="nx">DS</span> <span class="o">.</span> <span class="s1">&#39;vendor&#39;</span> <span class="o">.</span> <span class="nx">DS</span> <span class="o">.</span> <span class="s1">&#39;cakephp&#39;</span> <span class="o">.</span> <span class="nx">DS</span> <span class="o">.</span> <span class="s1">&#39;cakephp&#39;</span> <span class="o">.</span> <span class="nx">DS</span> <span class="o">.</span> <span class="s1">&#39;lib&#39;</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<p><strong>app/Console/cake.php</strong><br/>
So that the console commands can still find the right lib, we need to update the include path here too.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='php'><span class='line'><span class="nb">ini_set</span><span class="p">(</span><span class="s1">&#39;include_path&#39;</span><span class="p">,</span> <span class="s1">&#39;..&#39;</span> <span class="o">.</span> <span class="nv">$ds</span> <span class="o">.</span> <span class="s1">&#39;vendor&#39;</span> <span class="o">.</span> <span class="nv">$ds</span> <span class="o">.</span> <span class="s1">&#39;cakephp&#39;</span> <span class="o">.</span> <span class="nv">$ds</span> <span class="o">.</span> <span class="s1">&#39;cakephp&#39;</span> <span class="o">.</span> <span class="nv">$ds</span> <span class="o">.</span> <span class="s1">&#39;lib&#39;</span> <span class="o">.</span> <span class="nx">PATH_SEPARATOR</span> <span class="o">.</span> <span class="nb">ini_get</span><span class="p">(</span><span class="s1">&#39;include_path&#39;</span><span class="p">));</span>
</span></code></pre></td></tr></table></div></figure>


<p>As you are running your shell tasks from within <code>app</code> we can use a relative path.</p>

<h4>Testing</h4>

<p>To check that the new setup is working you can run a <code>Console/cake</code> to check what the <code>core</code> value is.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span><span class="nb">cd </span>app
</span><span class='line'><span class="nv">$ </span>Console/cake
</span><span class='line'>
</span><span class='line'>Welcome to CakePHP v2.5.3 Console
</span><span class='line'>---------------------------------------------------------------
</span><span class='line'>App : app
</span><span class='line'>Path: /Users/david/Sites/example/app/
</span><span class='line'>---------------------------------------------------------------
</span><span class='line'>Current Paths:
</span><span class='line'>
</span><span class='line'> -app: app
</span><span class='line'> -working: /Users/david/Sites/example/app
</span><span class='line'> -root: /Users/david/Sites/example
</span><span class='line'> -core: /Users/david/Sites/example/vendor/cakephp/cakephp/lib
</span></code></pre></td></tr></table></div></figure>


<h3>Done!</h3>

<p>Feel free to delete your old <code>lib</code> folder as you now don&rsquo;t need it. Have fun updating your applications version of CakePHP using Composer.</p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">David Yell</span></span>

      








  


<time datetime="2014-07-31T15:00:34+01:00" pubdate data-updated="true">Jul 31<sup>st</sup>, 2014</time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/2-dot-x/'>2.x</a>, <a class='category' href='/blog/categories/cakephp/'>cakephp</a>, <a class='category' href='/blog/categories/composer/'>composer</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  <a href="//twitter.com/share" class="twitter-share-button" data-url="http://jedistirfry.co.uk/blog/2014-07/converting-your-2-dot-x-application-to-require-cakephp/" data-via="yelldavid" data-counturl="http://jedistirfry.co.uk/blog/2014-07/converting-your-2-dot-x-application-to-require-cakephp/" >Tweet</a>
  
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2014-05/cakephp-project-from-scratch-using-composer/" title="Previous Post: Creating a CakePHP project using Composer">&laquo; Creating a CakePHP project using Composer</a>
      
      
        <a class="basic-alignment right" href="/blog/2014-08/sorting-data/" title="Next Post: Sorting multi-dimension model data">Sorting multi-dimension model data &raquo;</a>
      
    </p>
  </footer>
</article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2015-02/working-with-crud/">Working with the Crud plugin in CakePHP</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014-08/pt-visual-explain/">Installing and using pt-visual-explain</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014-08/sorting-data/">Sorting multi-dimension model data</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014-07/converting-your-2-dot-x-application-to-require-cakephp/">Requiring CakePHP 2.x using Composer</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014-05/cakephp-project-from-scratch-using-composer/">Creating a CakePHP project using Composer</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating...</li>
  </ul>
  
  <a href="https://github.com/davidyell">@davidyell</a> on GitHub
  
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'davidyell',
            count: 5,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>


<section>
  <h1>On Delicious</h1>
  <div id="delicious"></div>
  <script type="text/javascript" src="http://feeds.delicious.com/v2/json/neon1024?count=3&amp;sort=date&amp;callback=renderDeliciousLinks"></script>
  <p><a href="http://delicious.com/neon1024">My Delicious Bookmarks &raquo;</a></p>
</section>




  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2015 - David Yell -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'jedistirfry';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://jedistirfry.co.uk/blog/2014-07/converting-your-2-dot-x-application-to-require-cakephp/';
        var disqus_url = 'http://jedistirfry.co.uk/blog/2014-07/converting-your-2-dot-x-application-to-require-cakephp/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
